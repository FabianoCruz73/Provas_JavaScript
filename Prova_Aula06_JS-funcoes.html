<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerenciador de Tarefas (Prompt Personalizado)</title>
</head>
<body>
    <h1>Siga as instru√ß√µes dos pop-ups de di√°logo do navegador</h1>
    <h2>Digite F12 para acompanhar os comandos no console</h2>
    

    <script>
        const listaDeTarefas = []; // Array para armazenar as tarefas

        // --- Fun√ß√£o An√¥nima para Adicionar Tarefas ---
        const adicionarTarefa = function(tarefa) {
            console.log("‚û°Ô∏è Iniciando adi√ß√£o de tarefa...");
            if (tarefa && tarefa.trim() !== "") {
                listaDeTarefas.push(tarefa.trim());
                console.log(`‚úÖ Tarefa "${tarefa.trim()}" adicionada com sucesso.`);
                alert(`‚úÖ Tarefa "${tarefa.trim()}" adicionada √† lista!`);
                return true;
            }
            console.log("‚ùå Tarefa inv√°lida. Nada adicionado.");
            alert("‚ùå Tarefa inv√°lida. Nada adicionado.");
            return false;
        };

        // --- Arrow Function para Listar Tarefas ---
        const listarTarefas = () => {
            console.log("‚û°Ô∏è Iniciando listagem de tarefas...");
            let mensagemAlerta = "--- Suas Tarefas ---\n";
            if (listaDeTarefas.length === 0) {
                mensagemAlerta += "Nenhuma tarefa na lista.";
                console.log("INFO: Lista de tarefas vazia.");
            } else {
                console.log("INFO: Percorrendo e exibindo cada tarefa no console e preparando para o alert.");
                listaDeTarefas.forEach((tarefa, index) => {
                    mensagemAlerta += `${index + 1}: ${tarefa}\n`;
                    console.log(`  - Item ${index + 1}: "${tarefa}"`);
                });
            }
            mensagemAlerta += "--------------------";
            console.log("SUCESSO: Lista exibida no alert.");
            alert(mensagemAlerta);
        };

        // Fun√ß√£o auxiliar para obter a lista formatada para os prompts
        const getListaFormatadaParaPrompt = () => {
            let mensagem = "Sua lista atual:\n";
            if (listaDeTarefas.length === 0) {
                mensagem += "Nenhuma tarefa.";
            } else {
                listaDeTarefas.forEach((tarefa, index) => {
                    mensagem += `${index + 1}: ${tarefa}\n`;
                });
            }
            return mensagem;
        };

        // Fun√ß√£o auxiliar para validar √≠ndice
        const validarIndice = (indiceStr) => {
            const indice = parseInt(indiceStr);
            if (isNaN(indice) || indice < 1 || indice > listaDeTarefas.length) {
                const erroMsg = `‚ùå ERRO: √çndice inv√°lido "${indiceStr}". Por favor, digite um n√∫mero entre 1 e ${listaDeTarefas.length}.`;
                console.log(erroMsg);
                alert(erroMsg);
                return null;
            }
            return indice - 1; // Retorna o √≠ndice real (base 0)
        };

        // --- Fun√ß√µes de Callback para Manipular Tarefas ---
        const executarOperacaoNaTarefa = (operacaoCallback, promptMessage) => {
            if (listaDeTarefas.length === 0) {
                const alertaMsg = "‚ö†Ô∏è ALERTA: A lista de tarefas est√° vazia. Nenhuma opera√ß√£o pode ser realizada.";
                console.log(alertaMsg);
                alert(alertaMsg);
                return;
            }

            // Usa a 'promptMessage' personalizada
            const indiceStr = prompt(`${getListaFormatadaParaPrompt()}\n${promptMessage}`);
            const indiceReal = validarIndice(indiceStr);

            if (indiceReal !== null) {
                operacaoCallback(indiceReal); // Chama o callback com o √≠ndice validado
            }
        };

        // --- Callbacks Espec√≠ficos para as Opera√ß√µes ---
        const removerTarefaCallback = (indice) => {
            console.log("‚û°Ô∏è Executando remo√ß√£o...");
            const tarefaRemovida = listaDeTarefas.splice(indice, 1);
            console.log(`üóëÔ∏è Tarefa "${tarefaRemovida[0]}" removida com sucesso.`);
            alert(`üóëÔ∏è Tarefa "${tarefaRemovida[0]}" removida!`);
        };

        const atualizarTarefaCallback = (indice) => {
            console.log("‚û°Ô∏è Executando atualiza√ß√£o...");
            const novoNome = prompt(`Atualizar "${listaDeTarefas[indice]}". Digite o novo nome:`);
            if (novoNome && novoNome.trim() !== "") {
                const nomeAntigo = listaDeTarefas[indice];
                listaDeTarefas[indice] = novoNome.trim();
                console.log(`üîÑ Tarefa "${nomeAntigo}" atualizada para "${novoNome.trim()}" com sucesso.`);
                alert(`üîÑ Tarefa "${nomeAntigo}" atualizada para "${novoNome.trim()}".`);
            } else {
                console.log("‚ùå Nome de tarefa inv√°lido. Atualiza√ß√£o cancelada.");
                alert("‚ùå Nome de tarefa inv√°lido. Atualiza√ß√£o cancelada.");
            }
        };

        const concluirTarefaCallback = (indice) => {
            console.log("‚û°Ô∏è Executando conclus√£o...");
            let tarefaAtual = listaDeTarefas[indice];
            if (!tarefaAtual.startsWith("‚úÖ ")) {
                listaDeTarefas[indice] = `‚úÖ ${tarefaAtual}`;
                console.log(`‚úÖ Tarefa "${tarefaAtual}" marcada como conclu√≠da com sucesso.`);
                alert(`‚úÖ Tarefa "${tarefaAtual}" marcada como conclu√≠da!`);
            } else {
                console.log(`‚ö†Ô∏è Tarefa "${tarefaAtual}" j√° estava conclu√≠da.`);
                alert(`‚ö†Ô∏è Tarefa "${tarefaAtual}" j√° est√° marcada como conclu√≠da.`);
            }
        };

        // --- Intera√ß√£o com o Usu√°rio (Loop Principal) ---
        let continuar = true;
        console.log("--- Gerenciador de Tarefas Iniciado ---");

        const tituloAppTexto = "--- Gerenciador de Tarefas ---";
        const descricaoAppTexto = "Siga as instru√ß√µes dos pop-ups e tecle F12 para acompanhar os comandos no console";
        alert(`${tituloAppTexto}\n${descricaoAppTexto}\n\nClique OK para come√ßar!`);

        while (continuar) {
            const opcao = prompt(
                "--- Menu Principal ---\n" +
                "1. Adicionar Tarefa\n" +
                "2. Listar Tarefas\n" +
                "3. Remover Tarefa\n" +
                "4. Atualizar Tarefa\n" +
                "5. Concluir Tarefa\n" +
                "6. Sair\n\n" +
                "Escolha uma op√ß√£o (1-6):"
            );

            console.log(`\nOp√ß√£o escolhida pelo usu√°rio: ${opcao}`);
            
            if (opcao === '1') {
                const novaTarefa = prompt("Digite o nome da tarefa a ser adicionada:");
                adicionarTarefa(novaTarefa);
            } else if (opcao === '2') {
                listarTarefas();
            } else if (opcao === '3') {
                console.log("Chamando opera√ß√£o de remo√ß√£o.");
                // Passando a mensagem personalizada para o prompt
                executarOperacaoNaTarefa(removerTarefaCallback, "Digite o N√öMERO para REMOVER a tarefa:");
            } else if (opcao === '4') {
                console.log("Chamando opera√ß√£o de atualiza√ß√£o.");
                // Passando a mensagem personalizada para o prompt
                executarOperacaoNaTarefa(atualizarTarefaCallback, "Digite o N√öMERO para ATUALIZAR a tarefa:");
            } else if (opcao === '5') {
                console.log("Chamando opera√ß√£o de conclus√£o.");
                // Passando a mensagem personalizada para o prompt
                executarOperacaoNaTarefa(concluirTarefaCallback, "Digite o N√öMERO para CONCLUIR a tarefa:");
            } else if (opcao === '6') {
                console.log("Saindo do gerenciador de tarefas.");
                alert("üëã Saindo do gerenciador de tarefas. At√© mais!");
                continuar = false;
            } else {
                console.log("‚ùå Op√ß√£o inv√°lida. Por favor, escolha um n√∫mero de 1 a 6.");
                alert("‚ùå Op√ß√£o inv√°lida. Por favor, escolha um n√∫mero de 1 a 6.");
            }
            console.log("\n--- Fim da Intera√ß√£o Atual ---\n");
        }
        console.log("--- Gerenciador de Tarefas Finalizado ---");
    </script>
</body>
</html>